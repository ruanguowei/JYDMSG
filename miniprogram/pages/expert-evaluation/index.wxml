<!--pages/expert-evaluation/index.wxml-->
<view class="evaluation-container">

  <!-- 作品列表 -->
  <view class="submissions-list">
    <view wx:if="{{loading}}" class="loading">
      <view class="loading-spinner"></view>
      <text>加载中...</text>
    </view>

    <view wx:elif="{{submissions.length === 0}}" class="empty">
      <image src="/images/icons/noDate.png" class="empty-icon"></image>
      <text class="empty-text">暂无待评选作品</text>
    </view>

    <view wx:else>
      <view 
        wx:for="{{submissions}}" 
        wx:key="id"
        class="submission-item"
        data-id="{{item.id}}"
        bindtap="navigateToScoring"
      >
        <view class="submission-image">
          <image src="{{item.imageUrl}}" mode="aspectFill"></image>
        </view>
        
        <view class="submission-info">
          <view class="submission-title">{{item.title}}</view>
          <view class="submission-category">分类：{{item.categoryName}}</view>
        </view>
        
        <view class="submission-arrow">
          <text class="arrow">></text>
        </view>
      </view>
    </view>
  </view>

  <!-- 底部操作栏 -->
  <view class="bottom-actions">
    <button class="action-btn secondary" bindtap="showAdminLogin">
      获取结果
    </button>
    <button class="action-btn primary" bindtap="fetchSubmissions">
      刷新列表
    </button>
  </view>
</view>

<!-- 管理员登录弹窗 -->
<view wx:if="{{showAdminModal}}" class="admin-modal" bindtap="hideAdminModal">
  <view class="admin-modal-content" catchtap="stopPropagation">
    <view class="admin-modal-header">
      <view class="admin-modal-title">管理员登录</view>
      <view class="admin-modal-close" bindtap="hideAdminModal">×</view>
    </view>
    
    <view class="admin-modal-body">
      <view class="admin-form-item">
        <view class="admin-form-label">管理员账号</view>
        <input 
          class="admin-form-input" 
          placeholder="请输入管理员账号" 
          value="{{adminAccount}}"
          bindinput="onAdminAccountInput"
          maxlength="20"
        />
      </view>
      
      <view class="admin-form-item">
        <view class="admin-form-label">管理员密码</view>
        <input 
          class="admin-form-input" 
          placeholder="请输入管理员密码" 
          value="{{adminPassword}}"
          bindinput="onAdminPasswordInput"
          password="{{true}}"
          maxlength="20"
        />
      </view>
    </view>
    
    <view class="admin-modal-footer">
      <button class="admin-btn-cancel" bindtap="hideAdminModal">取消</button>
      <button 
        class="admin-btn-confirm {{adminLoading ? 'loading' : ''}}" 
        bindtap="confirmAdminLogin"
        disabled="{{adminLoading}}"
      >
        {{adminLoading ? '验证中...' : '确认登录'}}
      </button>
    </view>
  </view>
</view>

<!-- 进度提示弹窗 -->
<view wx:if="{{showProgressModal}}" class="progress-modal" bindtap="hideProgressModal">
  <view class="progress-modal-content" catchtap="stopPropagation">
    <view class="progress-modal-header">
      <view class="progress-modal-title">正在生成排名结果</view>
    </view>
    
    <view class="progress-modal-body">
      <view class="progress-spinner"></view>
      <view class="progress-text">此功能为组委会管理员专属：正在计算评分结果...</view>
    </view>
  </view>
</view>
